import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,a,o as t}from"./app-ByxOTFMR.js";const l={};function n(o,i){return t(),s("div",null,i[0]||(i[0]=[a(`<p>Outlook 于 2025 年 09 月全面淘汰，因此若要使用 Outlook 邮箱发件，需要使用微软提供的 Graph 方式。</p><p>UZonmail 提供两种发件方式：</p><ol><li>已知邮箱、ClientId 和 RefreshToken，可以直接添加发件</li><li>已知邮箱和密码，可以通过自己申请 ClientId 进行发件</li></ol><h2 id="refreshtoken-方式" tabindex="-1"><a class="header-anchor" href="#refreshtoken-方式"><span>RefreshToken 方式</span></a></h2><p>直接在 smtp用户名 栏填写 ClientId，在 smtp密码 栏填 refreshToken 即可。</p><p>其它参数保持默认(其它参数没用，默认即可)</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628161219594.png" alt="image-20250628161219594" tabindex="0" loading="lazy"><figcaption>image-20250628161219594</figcaption></figure><p>添加后，请务必进行验证。由于有的 ClientId 没有发件权限，即使有 RefreshToken 也无法使用。</p><h2 id="密码方式" tabindex="-1"><a class="header-anchor" href="#密码方式"><span>密码方式</span></a></h2><p>而使用 Graph 方式，则需要注册一个应用，获取 ClientId，本章内容将一步一步地介绍如何获取 ClientId。</p><h3 id="注册-micosoft-账户" tabindex="-1"><a class="header-anchor" href="#注册-micosoft-账户"><span>注册 Micosoft 账户</span></a></h3><p>通过该链接 <a href="https://signup.live.com/signup" target="_blank" rel="noopener noreferrer">https://signup.live.com/signup</a> 注册 Micosoft 账户。</p><h3 id="注册-microsoft-azure" tabindex="-1"><a class="header-anchor" href="#注册-microsoft-azure"><span>注册 Microsoft Azure</span></a></h3><p>可以通过以下两种试注册</p><ol><li><p>加入365开发者计划</p><p>单击链接 <a href="https://aka.ms/joinM365DeveloperProgram" target="_blank" rel="noopener noreferrer">https://aka.ms/joinM365DeveloperProgram</a> 加入 365 开发者计划。</p></li><li><p>使用信用卡激活 Azure</p><p>单击链接 <a href="https://aka.ms/signUpForAzure" target="_blank" rel="noopener noreferrer">https://aka.ms/signUpForAzure</a> 跳转</p></li></ol><h3 id="注册应用" tabindex="-1"><a class="header-anchor" href="#注册应用"><span>注册应用</span></a></h3><ol><li><p>进入 <a href="https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/Overview" target="_blank" rel="noopener noreferrer">Microsoft Entra ID</a></p><p>进入后如图所示:</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628153130413.png" alt="image-20250628153130413" tabindex="0" loading="lazy"><figcaption>image-20250628153130413</figcaption></figure></li><li><p>单击 <a href="https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps/CreateApplicationBlade/quickStartType~/null/isMSAApp~/false" target="_blank" rel="noopener noreferrer">应用注册/+新注册</a> 注册一个应用</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628153552853.png" alt="image-20250628153552853" tabindex="0" loading="lazy"><figcaption>image-20250628153552853</figcaption></figure><p><strong>特别注意</strong>：</p><ol><li>重定向 URI 中要选择 [公共客户端/本机(移动和桌面)]</li><li>当是桌面端时，重定向的 url 为 <code>http://localhost:22345/api/v1/outlook-authorization/code</code></li><li>当是服务器部署时，将地址改成服务器的域名地址</li><li>不支持局域网内部署</li><li>若是 443 端口，可以省略</li></ol></li><li><p>设置 API 权限</p><p>注册完成后，返回 <a href="https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/RegisteredApps" target="_blank" rel="noopener noreferrer">应用注册</a> 界面，切换到 [所有应用程序]，单击刚刚创建的程序进行设置界面</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628154403007.png" alt="image-20250628154403007" tabindex="0" loading="lazy"><figcaption>image-20250628154403007</figcaption></figure><p>从侧边栏切换到 [API 权限] -&gt; [+添加权限] -&gt; [ Microsoft Graph] -&gt; [委托的权限] 额外添加以下权限：</p><ul><li>Mail.Send</li><li>offline_access</li><li>openid</li></ul><p>操作如下图所示：</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628154724024.png" alt="image-20250628154724024" tabindex="0" loading="lazy"><figcaption>image-20250628154724024</figcaption></figure></li><li><p>授权管理员同意 [应该是可选，未测试]</p><p>单击 API 权限界面中的 [授予管理员同意]</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628155230619.png" alt="image-20250628155230619" tabindex="0" loading="lazy"><figcaption>image-20250628155230619</figcaption></figure></li><li><p>侧边栏切换到 [概述] 获取 ClientId</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628155444957.png" alt="image-20250628155444957" tabindex="0" loading="lazy"><figcaption>image-20250628155444957</figcaption></figure></li></ol><h3 id="配置后端" tabindex="-1"><a class="header-anchor" href="#配置后端"><span>配置后端</span></a></h3><p>在后端根目录(服务器版本为程序根目录，桌面端为 ./service 目录)中添加 <code>appsettings.Production.json</code>，在其中更新如下配置：</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // xxx 其它配置</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // 指定后端接口地址</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // 如果是桌面端，请删除该字段, 可以不用配置</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // 如果是服务器端，请根据自己实际地址进行配置，格式为 https://域名:端口</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // 若是本机 wsl docker 部署，wsl 的网络应设置为 mirror 模式</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;BaseUrl&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;https://maildemo.uzoncloud.com:22345&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // 用于设置 outlook、hotmail 授权参数</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;MicrosoftEntraApp&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    &quot;ClientId&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxxxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 你的 ClientId</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    &quot;TenantId&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 为空</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    &quot;ClientSecret&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // 为空</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="开始使用" tabindex="-1"><a class="header-anchor" href="#开始使用"><span>开始使用</span></a></h3><p>新建发件箱时，只需要输入 smtp发件邮箱，smtp用户名 和 smtp密码 保持为空，点保存即可。</p><p>如下图所示：</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628161936418.png" alt="image-20250628161936418" tabindex="0" loading="lazy"><figcaption>image-20250628161936418</figcaption></figure><p>保存后，会触发委托授权流程，按提示操作后，就可以进行发件了。</p><p>除了新建编辑后会触发委托授权流程，也可以在 outlook 发件箱上右键，点 [Outlook授权] 进行手动触发。</p>`,26)]))}const c=e(l,[["render",n],["__file","outlook.html.vue"]]),h=JSON.parse('{"path":"/guide/features/outlook","title":"Outlook发件","lang":"zh-CN","frontmatter":{"title":"Outlook发件","icon":"at","order":5,"description":"宇正群邮（UZonMail）Outlook发件指南，详细介绍如何通过微软Graph方式配置和使用Outlook邮箱进行邮件群发。支持开源邮件群发、邮件营销、企业级邮件群发场景，是最好用的邮件群发软件。","permalink":"/guide/features/outlook","head":[["link",{"rel":"alternate","hreflang":"en-us","href":"https://mail.uzoncloud.com/en/guide/features/outlook"}],["meta",{"property":"og:url","content":"https://mail.uzoncloud.com/guide/features/outlook"}],["meta",{"property":"og:site_name","content":"宇正群邮"}],["meta",{"property":"og:title","content":"Outlook发件"}],["meta",{"property":"og:description","content":"宇正群邮（UZonMail）Outlook发件指南，详细介绍如何通过微软Graph方式配置和使用Outlook邮箱进行邮件群发。支持开源邮件群发、邮件营销、企业级邮件群发场景，是最好用的邮件群发软件。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://oss.uzoncloud.com:2234/public/files/images/image-20250628161219594.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-07-03T05:44:19.000Z"}],["meta",{"property":"article:modified_time","content":"2025-07-03T05:44:19.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Outlook发件\\",\\"image\\":[\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628161219594.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628153130413.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628153552853.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628154403007.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628154724024.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628155230619.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628155444957.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628161936418.png\\"],\\"dateModified\\":\\"2025-07-03T05:44:19.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"uyoufu\\",\\"url\\":\\"https://uyoufu.uzoncloud.com/\\"}]}"]]},"headers":[{"level":2,"title":"RefreshToken 方式","slug":"refreshtoken-方式","link":"#refreshtoken-方式","children":[]},{"level":2,"title":"密码方式","slug":"密码方式","link":"#密码方式","children":[{"level":3,"title":"注册 Micosoft 账户","slug":"注册-micosoft-账户","link":"#注册-micosoft-账户","children":[]},{"level":3,"title":"注册 Microsoft Azure","slug":"注册-microsoft-azure","link":"#注册-microsoft-azure","children":[]},{"level":3,"title":"注册应用","slug":"注册应用","link":"#注册应用","children":[]},{"level":3,"title":"配置后端","slug":"配置后端","link":"#配置后端","children":[]},{"level":3,"title":"开始使用","slug":"开始使用","link":"#开始使用","children":[]}]}],"git":{"createdTime":1751099629000,"updatedTime":1751521459000,"contributors":[{"name":"galens","username":"galens","email":"gmx_galens@163.com","commits":3,"url":"https://github.com/galens"},{"name":"galens.gmx","username":"galens.gmx","email":"260827400@qq.com","commits":4,"url":"https://github.com/galens.gmx"}]},"readingTime":{"minutes":3.05,"words":914},"filePathRelative":"guide/features/outlook.md","localizedDate":"2025年6月28日"}');export{c as comp,h as data};
