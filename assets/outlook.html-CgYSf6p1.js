import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,a as s,o as a}from"./app-Cl6cCFA5.js";const o={};function n(l,i){return a(),t("div",null,i[0]||(i[0]=[s(`<p>As of September 2025 Outlook&#39;s legacy authentication is deprecated, so to send via Outlook you must use Microsoft&#39;s Graph API.</p><p>UzonMail provides two sending methods:</p><ol><li>If you already have the email, ClientId and RefreshToken, you can add the sender directly.</li><li>If you have the email and password, you can register your own ClientId and use it for sending.</li></ol><h2 id="refreshtoken-method" tabindex="-1"><a class="header-anchor" href="#refreshtoken-method"><span>RefreshToken method</span></a></h2><p>Fill <code>ClientId</code> in the SMTP username field and put the <code>refreshToken</code> in the SMTP password field. Other parameters can remain as default.</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628161219594.png" alt="outlook refresh token" tabindex="0" loading="lazy"><figcaption>outlook refresh token</figcaption></figure><p>After adding, be sure to validate the account. Some ClientIds may not have send permissions, so even with a RefreshToken they may not work.</p><h2 id="password-method" tabindex="-1"><a class="header-anchor" href="#password-method"><span>Password method</span></a></h2><p>Using Graph with a password requires registering an app to obtain a ClientId. This section walks through obtaining a ClientId.</p><h3 id="register-a-microsoft-account" tabindex="-1"><a class="header-anchor" href="#register-a-microsoft-account"><span>Register a Microsoft account</span></a></h3><p>Sign up at: <a href="https://signup.live.com/signup" target="_blank" rel="noopener noreferrer">https://signup.live.com/signup</a></p><h3 id="register-for-microsoft-azure" tabindex="-1"><a class="header-anchor" href="#register-for-microsoft-azure"><span>Register for Microsoft Azure</span></a></h3><p>Two options to get started:</p><ol><li>Join the Microsoft 365 Developer Program: <a href="https://aka.ms/joinM365DeveloperProgram" target="_blank" rel="noopener noreferrer">https://aka.ms/joinM365DeveloperProgram</a></li><li>Activate Azure with a credit card: <a href="https://aka.ms/signUpForAzure" target="_blank" rel="noopener noreferrer">https://aka.ms/signUpForAzure</a></li></ol><h3 id="register-an-application" tabindex="-1"><a class="header-anchor" href="#register-an-application"><span>Register an application</span></a></h3><ol><li><p>Open Microsoft Entra ID: <a href="https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/Overview" target="_blank" rel="noopener noreferrer">https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/Overview</a></p><p>Example view:</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628153130413.png" alt="entra overview" tabindex="0" loading="lazy"><figcaption>entra overview</figcaption></figure></li><li><p>Click &quot;App registrations&quot; → &quot;+ New registration&quot; to register an app.</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628153552853.png" alt="new app" tabindex="0" loading="lazy"><figcaption>new app</figcaption></figure><p>Notes:</p><ol><li>For Redirect URI choose &quot;Public client/native (mobile &amp; desktop)&quot;.</li><li>For desktop, the redirect URL should be <code>http://localhost:22345/api/v1/outlook-authorization/code</code>.</li><li>For server deployments, use your server domain as the redirect URL.</li><li>LAN-only deployments are not supported.</li><li>If using port 443, the port can be omitted.</li></ol></li><li><p>Configure API permissions</p><p>After registration, go to App registrations → All applications and open your app&#39;s settings.</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628154403007.png" alt="app settings" tabindex="0" loading="lazy"><figcaption>app settings</figcaption></figure><p>Add the following delegated Microsoft Graph permissions:</p><ul><li>Mail.Send</li><li>offline_access</li><li>openid</li></ul><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628154724024.png" alt="add permissions" tabindex="0" loading="lazy"><figcaption>add permissions</figcaption></figure></li><li><p>Grant admin consent (optional, not tested)</p><p>Click &quot;Grant admin consent&quot; on the API permissions page if required.</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628155230619.png" alt="grant consent" tabindex="0" loading="lazy"><figcaption>grant consent</figcaption></figure></li><li><p>Get ClientId from the Overview page</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628155444957.png" alt="client id" tabindex="0" loading="lazy"><figcaption>client id</figcaption></figure></li></ol><h3 id="backend-configuration" tabindex="-1"><a class="header-anchor" href="#backend-configuration"><span>Backend configuration</span></a></h3><p>In the backend root (server edition: program root; desktop: ./service) add <code>appsettings.Production.json</code> and update:</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // other config ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Base API URL</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // For desktop remove this field or leave empty</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // For server, set to your domain like https://your-domain:port</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;BaseUrl&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;https://maildemo.uzoncloud.com:22345&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Outlook / Hotmail authorization settings</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;MicrosoftEntraApp&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    &quot;ClientId&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxxxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    &quot;TenantId&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    &quot;ClientSecret&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="start-using" tabindex="-1"><a class="header-anchor" href="#start-using"><span>Start using</span></a></h3><p>When creating a new sender mailbox, enter the SMTP email address and leave the SMTP username and password empty, then save.</p><figure><img src="https://oss.uzoncloud.com:2234/public/files/images/image-20250628161936418.png" alt="add outlook sender" tabindex="0" loading="lazy"><figcaption>add outlook sender</figcaption></figure><p>Saving will trigger the delegated authorization flow; follow the prompts to complete authorization and then sending will be enabled.</p><p>You can also right-click an Outlook sender mailbox and choose &quot;Outlook Authorization&quot; to manually trigger the flow.</p>`,24)]))}const d=e(o,[["render",n],["__file","outlook.html.vue"]]),c=JSON.parse('{"path":"/en/guide/features/outlook","title":"Outlook Sending","lang":"en-US","frontmatter":{"title":"Outlook Sending","icon":"at","order":5,"description":"Guide for configuring Outlook sending via Microsoft Graph in UzonMail.","permalink":"/en/guide/features/outlook","head":[["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://mail.uzoncloud.com/guide/features/outlook"}],["meta",{"property":"og:url","content":"https://mail.uzoncloud.com/en/guide/features/outlook"}],["meta",{"property":"og:site_name","content":"UzonMail"}],["meta",{"property":"og:title","content":"Outlook Sending"}],["meta",{"property":"og:description","content":"Guide for configuring Outlook sending via Microsoft Graph in UzonMail."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://oss.uzoncloud.com:2234/public/files/images/image-20250628161219594.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Outlook Sending\\",\\"image\\":[\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628161219594.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628153130413.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628153552853.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628154403007.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628154724024.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628155230619.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628155444957.png\\",\\"https://oss.uzoncloud.com:2234/public/files/images/image-20250628161936418.png\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"uyoufu\\",\\"url\\":\\"https://uyoufu.uzoncloud.com/\\"}]}"]]},"headers":[{"level":2,"title":"RefreshToken method","slug":"refreshtoken-method","link":"#refreshtoken-method","children":[]},{"level":2,"title":"Password method","slug":"password-method","link":"#password-method","children":[{"level":3,"title":"Register a Microsoft account","slug":"register-a-microsoft-account","link":"#register-a-microsoft-account","children":[]},{"level":3,"title":"Register for Microsoft Azure","slug":"register-for-microsoft-azure","link":"#register-for-microsoft-azure","children":[]},{"level":3,"title":"Register an application","slug":"register-an-application","link":"#register-an-application","children":[]},{"level":3,"title":"Backend configuration","slug":"backend-configuration","link":"#backend-configuration","children":[]},{"level":3,"title":"Start using","slug":"start-using","link":"#start-using","children":[]}]}],"git":{},"readingTime":{"minutes":1.63,"words":489},"filePathRelative":"en/guide/features/outlook.md"}');export{d as comp,c as data};
